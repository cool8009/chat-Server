(this["webpackJsonpmychat.frontend"]=this["webpackJsonpmychat.frontend"]||[]).push([[0],{162:function(e,t,n){},192:function(e,t,n){},195:function(e,t,n){"use strict";n.r(t);var s=n(0),c=n.n(s),r=n(36),a=n.n(r),o=(n(162),n(34)),i=n.n(o),u=n(124),l=n(71),j=n(39),h=n(76),b=n.n(h);b.a.defaults.baseURL="http://localhost:9223/api";var d=function(e){return e.data},f=function(e){return b.a.get(e).then(d)},p=function(e,t){return b.a.post(e,t).then(d)},g={Messages:{list:function(){try{return f("/messages")}catch(e){console.log(e)}},create:function(e){return p("/messages",e)}},Account:{current:function(){return f("/account")},login:function(e){return p("/account/login",e)},register:function(e){return p("/account/register",e)}}},m=n(121),O=n(213),v=n(214),x=n(3),k=n(210),w=n(142),y=function(e){var t=e.sendMessage,n=Object(s.useState)(""),c=Object(j.a)(n,2),r=c[0],a=c[1];return Object(x.jsx)(O.a,{onSubmit:function(e){e.preventDefault(),t(r),a("")},children:Object(x.jsxs)(k.a,{children:[Object(x.jsx)(w.a,{type:"user",placeholder:"message...",onChange:function(e){return a(e.target.value)},value:r}),Object(x.jsx)(k.a.Append,{children:Object(x.jsx)(v.a,{variant:"primary",type:"submit",disabled:!r,children:"Send"})})]})})},C=function(e){var t=e.messages,n=e.prevMessages,c=Object(s.useRef)();return Object(s.useEffect)((function(){if(c&&c.current){var e=c.current,t=e.scrollHeight,n=e.clientHeight;c.current.scrollTo({left:0,top:t-n,behavior:"smooth"})}}),[t]),Object(x.jsxs)("div",{ref:c,className:"message-container",children:[n.map((function(e,t){return Object(x.jsxs)("div",{className:"user-message",children:[Object(x.jsx)("div",{className:"message bg-primary",children:e.message}),Object(x.jsx)("div",{className:"from-user",children:"placeholderuser"})]},t)})),t.map((function(e,t){return Object(x.jsxs)("div",{className:"user-message",children:[Object(x.jsx)("div",{className:"message bg-primary",children:e.message}),Object(x.jsx)("div",{className:"from-user",children:e.user})]},t)}))]})},S=function(e){var t=e.users;return Object(x.jsxs)("div",{className:"user-list",children:[Object(x.jsx)("h4",{children:"Connected Users"}),t.map((function(e,t){return Object(x.jsx)("h6",{children:e},t)}))]})},N=function(e){var t=e.sendMessage,n=e.messages,s=e.users,c=e.closeConnection,r=e.prevMessages;return Object(x.jsxs)("div",{children:[Object(x.jsx)("div",{className:"leave-chat",children:Object(x.jsx)(v.a,{variant:"danger",onClick:function(){return c()},children:"Leave"})}),Object(x.jsx)(S,{users:s}),Object(x.jsxs)("div",{className:"chat",children:[Object(x.jsx)(C,{prevMessages:r,messages:n}),Object(x.jsx)(y,{sendMessage:t})]})]})},M=n(215),L=n(211),I=n(122),T=n(196);function U(){return Object(x.jsx)(M.a,{inverted:!0,fixed:"top",className:"menu",children:Object(x.jsxs)(L.a,{children:[Object(x.jsx)(I.a,{className:"item",children:"Backgammon"}),Object(x.jsx)(I.a,{children:Object(x.jsx)(T.a,{to:"/lobby",positive:!0,content:"Lobby"})})]})})}var A=n(18),B=(n(192),n(193),n(120)),F=n(148),J=n(212),E=n(145),P=n(146),R=n(10),D={userStore:new(function(){function e(){var t=this;Object(E.a)(this,e),this.user=null,this.token=null,this.appLoaded=!1,this.login=function(){var e=Object(l.a)(i.a.mark((function e(n){var s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.Account.login(n);case 3:s=e.sent,t.setToken(s.token),Object(R.o)((function(){return t.user=s})),console.log(s),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),this.setToken=function(e){e&&window.localStorage.setItem("jwt_token",e),t.token=e},this.setAppLoaded=function(){t.appLoaded=!0},Object(R.l)(this)}return Object(P.a)(e,[{key:"isLoggedIn",get:function(){return!!this.user}}]),e}())},H=Object(s.createContext)(D);var V=Object(F.a)((function(e){var t=e.joinChat,n=Object(s.useContext)(H).userStore;return Object(x.jsx)(B.b,{initialValues:{username:"",password:""},onSubmit:function(e){console.log(JSON.stringify(e,null,2)),n.login(e),t(e.username)},children:function(e){var t=e.handleSubmit,n=e.isSubmitting,s=e.handleChange;return Object(x.jsxs)(B.a,{className:"ui form",onSubmit:t,autoComplete:"off",children:[Object(x.jsx)(J.a,{name:"username",placeholder:"User",onChange:s}),Object(x.jsx)(J.a,{name:"password",placeholder:"Password",type:"password",onChange:s}),Object(x.jsx)(T.a,{loading:n,positive:!0,content:"Login",type:"submit",fluid:!0})]})}})}));function _(){return Object(x.jsx)(L.a,{children:Object(x.jsx)("h1",{children:"homepage"})})}var q=function(){var e=Object(s.useState)(),t=Object(j.a)(e,2),n=t[0],c=t[1],r=Object(s.useState)([]),a=Object(j.a)(r,2),o=a[0],h=a[1],b=Object(s.useState)([]),d=Object(j.a)(b,2),f=d[0],p=d[1],O=Object(s.useState)([]),v=Object(j.a)(O,2),k=v[0],w=v[1];Object(s.useEffect)((function(){g.Messages.list().then((function(e){console.log(e),w(e)}))}),[]);var y=function(){var e=Object(l.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(n=(new m.a).withUrl("http://localhost:9223/chat").configureLogging(m.b.Information).build()).on("ReceiveMessage",(function(e,t){h((function(n){return[].concat(Object(u.a)(n),[{user:e,message:t}])})),w((function(e){return[].concat(Object(u.a)(e),[t])}))})),n.on("UsersInChat",(function(e){p(e)})),n.onclose((function(e){c(),h([]),p([])})),e.next=7,n.start();case 7:return e.next=9,n.invoke("JoinChat",{user:t});case 9:c(n),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(l.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.invoke("SendMessage",t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.stop();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return Object(x.jsxs)("div",{className:"app",children:[Object(x.jsx)(U,{}),Object(x.jsx)("h2",{children:"Backgammon Chat"}),Object(x.jsx)(A.a,{path:"/",component:_}),Object(x.jsx)(A.a,{path:"/chat",component:N}),Object(x.jsx)(A.a,{path:"/",component:_}),n?Object(x.jsx)(N,{sendMessage:C,prevMessages:k,messages:o,users:f,closeConnection:S}):Object(x.jsx)(V,{joinChat:y})]})},z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,217)).then((function(t){var n=t.getCLS,s=t.getFID,c=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),s(e),c(e),r(e),a(e)}))},G=n(117);a.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsx)(G.a,{children:Object(x.jsx)(q,{})})}),document.getElementById("root")),z()}},[[195,1,2]]]);
//# sourceMappingURL=main.34f4e936.chunk.js.map